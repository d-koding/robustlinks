var RLuriPatternsToExclude=["https?://dx.doi.org*","https?://doi.org*"],RLhasHTTPRegexp=/^https?:/,RLhasColonRegexp=/:/;function RLIsURL(t){return Boolean(t)&&(RLhasHTTPRegexp.test(t)||!RLhasColonRegexp.test(t))}var RLWebArchiveBaseUriToExclude=["https?://webarchive.nationalarchives.gov.uk/*","https?://web.archive.org/*"],RLSchemaOrgAttributes={datePublished:"Visit link near page creation date ",dateModified:"Visit link near page modified date "};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=this.length;e--;)if(this[e]===t)return e;return-1});var RL_ID=function(){return"RL_"+Math.random().toString(36).substr(2,9)};function RL_appendHiddenLink(t,e,r){var n=document.createElement("li"),a=document.createElement("div"),i=document.createElement("a");i.setAttribute("class","robustLinks RLItem"),i.href=r,i.innerHTML=e,a.appendChild(i),n.appendChild(a),t.appendChild(n)}function RLAddZero(t){return t<10&&(t="0"+t),t}function RLFormatDate(t){var e=new Date(t);if(isNaN(e)&&(e=new Date(t.replace(/ /g,"T")),isNaN(e)))return"Invalid date";var r="";return r+=e.getUTCFullYear(),r+=RLAddZero(e.getUTCMonth()+1),r+=RLAddZero(e.getUTCDate()),r+=RLAddZero(e.getUTCHours()),r+=RLAddZero(e.getUTCMinutes()),r+=RLAddZero(e.getUTCSeconds())}function RLPrintDate(t){var e=RLFormatDate(t),r=e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substr(6,2);return"000000"!=e.substr(8,6)&&(r+=" "+e.substr(8,2)+":"+e.substr(10,2)+":"+e.substr(12,2)),r}var RLLastOpen,RLDomainRegExp=new RegExp("(?:https?://)?(?:www\\.)?((?:[A-Za-z0-9_\\.])+)(?:/.*)?","i");function RLPrintDomainName(t){var e=t.match(RLDomainRegExp);if(e&&e.length>1){var r=e[1];return r.length>15?r.substr(0,15)+"...":r}return"unknown archive"}function RLCloseLastOpen(){RLLastOpen&&(RLLastOpen.setAttribute("aria-hidden","true"),RLLastOpen=null)}function RLGetAttribute(t,e){try{return t.getAttribute(e).trim()}catch(t){return""}}function robustify_links_on_page(){console.log("callable robust links started...");for(var t=document.getElementsByTagName("meta"),e={},r=0;r<t.length;r++){var n=RLGetAttribute(t[r],"itemprop");if(n in RLSchemaOrgAttributes){var a=RLGetAttribute(t[r],"content");e[n]={linkstr:"",printstr:""},e[n].linkstr=RLFormatDate(a),e[n].printstr=RLPrintDate(a)}}var i=document.getElementsByTagName("a");for(r=0;r<i.length;r++){var o=RLGetAttribute(i[r],"href");if(console.log("examining href value "+o),0==!o.search("http")){var s=window.location,u=s.protocol+"//"+s.host;0==!o.search("/|../|./")&&(u+="/"),o=u+o}var d=RLGetAttribute(i[r],"data-originalurl");console.log("got original value of "+d);var l=Boolean(d);l||(d=o);var L=RLGetAttribute(i[r],"data-versionurl");console.log("got memento value of "+L);var c=Boolean(L);!c&&l&&(L=o);var p=RLGetAttribute(i[r],"data-versiondate");console.log("got datetime of "+p);var R=Boolean(p),m=new RegExp("(?:"+RLuriPatternsToExclude.join(")|(?:")+")"),h=i[r].href.length>0&&(" "+i[r].className+" ").indexOf(" robustLinks ")<0&&(Object.keys(e).length>0||l||c||R)&&!m.test(o)&&RLIsURL(o);if(console.log("showLink is "),console.log(h),h){var g=RL_ID(),b=document.createElement("span");b.setAttribute("role","navigation"),b.setAttribute("aria-label","RLElement");var v=document.createElement("ul"),f=document.createElement("li");f.setAttribute("aria-label","RLOuter");var A=document.createElement("a");A.href="",A.setAttribute("aria-haspopup","true"),A.setAttribute("class","robustLinks dropDownButton RLArrow"),A.setAttribute("aria-controls",g);var k=document.createElement("div");k.setAttribute("class","robustLinks dropDownButton RLIcon");var E=document.createElement("ul");E.setAttribute("class","RLMenu"),E.id=g,E.setAttribute("aria-hidden","true");var C=document.createElement("li");for(n in C.setAttribute("class","RLTitle"),C.innerHTML="Robust Links",E.appendChild(C),e){var D="http://timetravel.mementoweb.org/memento/"+e[n].linkstr+"/"+d;RL_appendHiddenLink(E,RLSchemaOrgAttributes[n]+e[n].printstr,D)}if(R){D="http://timetravel.mementoweb.org/memento/"+RLFormatDate(p)+"/"+d;RL_appendHiddenLink(E,"Visit an archived version near date<br>"+RLPrintDate(p),D)}c&&RL_appendHiddenLink(E,"Visit the archived version at "+RLPrintDomainName(L),L),l&&RL_appendHiddenLink(E,"Visit current version",d),f.appendChild(A),f.appendChild(E),v.appendChild(f),b.appendChild(v),A.parentNode.insertBefore(k,A),A.onclick=function(t){var e=document.getElementById(this.getAttribute("aria-controls")),r="true"==e.getAttribute("aria-hidden");return RLCloseLastOpen(),r?(e.setAttribute("aria-hidden","false"),RLLastOpen=e):(e.setAttribute("aria-hidden","true"),RLLastOpen=null),t.stopPropagation(),!1},i[r].parentNode.insertBefore(b,i[r].nextSibling)}}document.onclick=RLCloseLastOpen}document.addEventListener("DOMContentLoaded",function(){robustify_links_on_page()},!1);